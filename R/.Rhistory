ind_whill
whill[931]
w[94]
?plot_grid
adf_gof_hill
plot_grid(plot(adf_gof_hill[[1]]), plot(adf_gof_hill2[[1]]), plot(adf_gof_cl[[1]]), plot(adf_gof_cl2[[1]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[2]]), plot(adf_gof_hill2[[2]]), plot(adf_gof_cl[[2]]), plot(adf_gof_cl2[[2]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
ind_whill
whill[371]
plot_grid(plot(adf_gof_hill[[3]]), plot(adf_gof_hill2[[3]]), plot(adf_gof_cl[[3]]), plot(adf_gof_cl2[[3]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
whill[251]
plot_grid(plot(adf_gof_hill[[4]]), plot(adf_gof_hill2[[4]]), plot(adf_gof_cl[[4]]), plot(adf_gof_cl2[[4]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
adf_gof_hill <- list(adf_gof(adf_hill), ind_whill[1])
adf_gof_hill <- list(adf_gof(adf_hill), ind_w = ind_whill[1])
adf_gof_hill <- list(adf_gof(adf_hill, ind_w = ind_whill[1]))
adf_gof_hill <- adf_gof(adf_hill, w_ind = ind_whill[1])
plot(adf_gof_hill)
adf_gof_hill <- adf_gof(adf_hill, w_ind = ind_whill[2])
plot(adf_gof_hill)
adf_gof_hill <- adf_gof(adf_hill, w_ind = ind_whill[3])
plot(adf_gof_hill)
adf_gof_hill <- adf_gof(adf_hill, w_ind = ind_whill[4])
plot(adf_gof_hill)
adf_gof_hill <- adf_gof(adf_hill, w_ind = ind_whill[5])
plot(adf_gof_hill)
adf_gof_hill <- adf_gof(adf_hill, w_ind = 901)
plot(adf_gof_hill)
acf(sealevel[, 1])
?acf
acf(sealevel[, 1], na.pass)
acf(sealevel[, 1], na.action = na.pass)
acf(sealevel[, 2], na.action = na.pass)
adf_gof_hill <- adf_gof(adf_hill, w_ind = 901, blocksize = 4)
adf_gof_hill <- sapply(ind_whill, adf_gof, adf = adf_hill, blocksize = 1, nboot = 250, alpha = 0.05)
plot_grid(plot(adf_gof_hill[[4]]), plot(adf_gof_hill2[[4]]), plot(adf_gof_cl[[4]]), plot(adf_gof_cl2[[4]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
whill[ind_whill]
plot_grid(plot(adf_gof_hill[[5]]), plot(adf_gof_hill2[[5]]), plot(adf_gof_cl[[5]]), plot(adf_gof_cl2[[5]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot(adf_gof(pmax(whill, 1-whill), w_ind = 901, blocksize = 4))
adf_gof(adf_hill, w_ind = 901, blocksize = 1)
adf_gof(adf_hill, w_ind = 901, blocksize = 2)
adf_gof(adf_hill, w_ind = 901, blocksize = 3)
adf_gof(adf_hill, w_ind = 901, blocksize = 4)
adf_gof(adf_hill, w_ind = 901, blocksize = 5)
ReturnCurves:::minproj_lambda(data = adf_hill@data, w = whill[901], q_minproj = 09.5)
ReturnCurves:::minproj_lambda(data = adf_hill@data, w = whill[901], q_minproj = 0.95)
?adf_gof
min_proj <- ReturnCurves:::minproj_lambda(data = adf_hill@data, w = whill[901], q_minproj = 0.95)
(min_proj$minproj - min_proj$thresh)[min_proj$minproj > min_proj$thresh]
min_proj <- ReturnCurves:::minproj_lambda(data = adf_hill@data, w = whill[901], q_minproj = 0.85)
(min_proj$minproj - min_proj$thresh)[min_proj$minproj > min_proj$thresh]
ReturnCurves:::minproj_lambda(data = adf_hill@data, w = whill[901], q_minproj = 0.85)
adf_gof(adf_hill, w_ind = 901, q = 0.85)
(data = margdata@dataexp, w = whill, method = "hill", q = 0.95)
adf_est(data = margdata@dataexp, w = whill, method = "hill", q = 0.95)
adf_est(data = margdata@dataexp, w = whill, method = "hill", q = 0.85)
plot(adf_est(data = margdata@dataexp, w = whill, method = "hill", q = 0.85))
a <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = 0.85)
plot(adf_gof(a, w_ind = 901))
dim(adf_hill@adf)
(min_proj$minproj - min_proj$thresh)[min_proj$minproj > min_proj$thresh]
excdata <- (min_proj$minproj - min_proj$thresh)[min_proj$minproj > min_proj$thresh]
excadata
excdata
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill")
excdata <- adf_hill@adf[901] * excdata
excdata
ReturnCurves:::block_bootstrap_function(data = excdata, k = 1, n = length(excdata))
ReturnCurves:::block_bootstrap_function(data = excdata, k = 5, n = length(excdata))
ReturnCurves:::block_bootstrap_function(data = excdata, k = 6, n = length(excdata))
ReturnCurves:::block_bootstrap_function(data = excdata, k = 7, n = length(excdata))
ReturnCurves:::block_bootstrap_function(data = excdata, k = 8, n = length(excdata))
rm(list = ls())
library(ReturnCurves)
library(evd)
library(ReturnCurves)
library(evd)
## sea level
data("sealevel")
margdata <- margtransf(sealevel, qmarg = 0.85)
plot(margdata) # same as plot(margdata, which = "all")
whill <- seq(0, 1, by = 0.001)
w <- seq(0, 1, by = 0.01)
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = 0.85)
adf_hill2 <- adf_est(data = margdata@dataexp, w = whill, method = "hill", constrained = T, q = 0.85)
adf_cl <- adf_est(data = margdata@dataexp, method = "cl", q = 0.85)
adf_cl2 <- adf_est(data = margdata@dataexp, method = "cl", constrained = T, q = 0.85)
library(cowplot)
plot_grid(plot(adf_hill), plot(adf_hill2), plot(adf_cl), plot(adf_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
### for a few angles
samew <- which(whill %in% w)
ind_whill <- sample(samew, 5, replace = F)
ind_w <- sapply(1:5, function(i) which(w == whill[ind_whill][i]))
sapply(ind_whill, adf_gof, adf = adf_hill, blocksize = 8, nboot = 250, alpha = 0.05)
adf_gof_hill <- sapply(ind_whill, adf_gof, adf = adf_hill, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_hill2 <- sapply(ind_whill, adf_gof, adf = adf_hill2, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_cl <- sapply(ind_w, adf_gof, adf = adf_cl, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_cl2 <- sapply(ind_w, adf_gof, adf = adf_cl2, blocksize = 1, nboot = 250, alpha = 0.05)
plot_grid(plot(adf_gof_hill[[1]]), plot(adf_gof_hill2[[1]]), plot(adf_gof_cl[[1]]), plot(adf_gof_cl2[[1]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[2]]), plot(adf_gof_hill2[[2]]), plot(adf_gof_cl[[2]]), plot(adf_gof_cl2[[2]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[3]]), plot(adf_gof_hill2[[3]]), plot(adf_gof_cl[[3]]), plot(adf_gof_cl2[[3]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[4]]), plot(adf_gof_hill2[[4]]), plot(adf_gof_cl[[4]]), plot(adf_gof_cl2[[4]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[5]]), plot(adf_gof_hill2[[5]]), plot(adf_gof_cl[[5]]), plot(adf_gof_cl2[[5]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
whill[ind_whill]
?rc_est
10/dim(sealevel)[1]
prob <- 10/dim(sealevel)[1]
curve_hill <- rc_est(data = data, qmarg = 0.85, w = whill, p = prob, method = "hill", q = 0.85)
curve_hill <- rc_est(data = sealevel, qmarg = 0.85, w = whill, p = prob, method = "hill", q = 0.85)
1-0.85
prob
1-0.95
20/dim(sealevel)[1]
1/dim(sealevel)[1]
5/dim(sealevel)[1]
2/dim(sealevel)[1]
prob <- 0.04
curve_hill <- rc_est(data = sealevel, qmarg = 0.85, w = whill, p = prob, method = "hill", q = 0.85)
curve_hill2 <- rc_est(data = sealevel, qmarg = 0.85, w = whill, p = prob, method = "hill", q = 0.85, constrained = T)
curve_cl <- rc_est(data = sealevel, qmarg = 0.85, p = prob, method = "cl", q = 0.85)
curve_cl2 <- rc_est(data = sealevel, qmarg = 0.85, p = prob, method = "cl", q = 0.85, constrained = T)
plot_grid(plot(curve_hill), plot(curve_hill2), plot(curve_cl), plot(curve_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
?rc_gof
rc_gof_hill <- rc_gof(curve_hill)
rc_gof_hill2 <- rc_gof(curve_hill2)
rc_gof_cl <- rc_gof(curve_cl)
rc_gof_cl2 <- rc_gof(curve_cl2)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(curve_hill), plot(curve_hill2), plot(curve_cl), plot(curve_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
?rc_unc
rc_unc_hill <- rc_unc(curve_hill)
rc_unc_hill2 <- rc_unc(data, w = whill, p = prob, method = "hill", constrained = T)
warnings()
rc_unc_hill2 <- rc_unc(curve_hill2)
warnings()
ismev:::gpd.fit
evd:::qgpd
rc_unc_hill2 <- rc_unc(curve_hill2)
evd:::pgpdg
evd:::pgpd
ismev:::gpd.fit
curve_hill <- rc_est(data = sealevel, qmarg = 0.8, w = whill, p = prob, method = "hill", q = 0.8)
curve_hill <- rc_est(data = sealevel, qmarg = 0.75, w = whill, p = prob, method = "hill", q = 0.75)
apply(sealevel, 2, quantile, na.rm = T)
?quantile
us <- apply(sealevel, 2, quantile, probs <- seq(0, 0.95, by = 0.05), na.rm = T)
us
sapply(sealevel[, 1], function(i) i[i > thresh])
sapply(sealevel[, 1], function(i) i[i > us])
sealevel[, 1][sealevel[, 1] - us[1]]
head(sealevel)
head(us)
us[, 1]
sealevel[, 1][sealevel[, 1] - us[1, 1]]
sealevel$dover[sealevel$dover > us[1, 1]]
sealevel$dover[sealevel$dover > us[1, 1]] - us[1, 1]
dim(sealevel$dover[sealevel$dover > us[1, 1]])
length(sealevel$dover[sealevel$dover > us[1, 1]])
sealevel$dover[sealevel$dover > us[, 1]] - us[, 1]
sapply(1:dim(us)[1], function(i) length(sealevel$dover[sealevel$dover > us[i, 1]]))
sapply(1:dim(us)[1], function(i) length(sealevel$harwich[sealevel$harwich > us[i, 2]]))
sld <- sealevel$dover[complete.cases(sealevel$dover)]
sapply(1:dim(us)[1], function(i) length(sld[sld > us[i, 1]]))
slh <- sealevel$harwich[complete.cases(sealevel$harwich)]
sapply(1:dim(us)[1], function(i) length(slh[slh > us[i, 2]]))
seq(0, 0.95, by = 0.05)
q <- 0.65
margdata <- margtransf(sealevel, qmarg = q)
plot(margdata) # same as plot(margdata, which = "all")
plot(margdata, which = "hist")
plot(margdata, which = "ts")
plot(margdata, which = "joint")
whill <- seq(0, 1, by = 0.001)
w <- seq(0, 1, by = 0.01)
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = q)
adf_hill2 <- adf_est(data = margdata@dataexp, w = whill, method = "hill", constrained = T, q = q)
adf_cl <- adf_est(data = margdata@dataexp, method = "cl", q = q)
adf_cl2 <- adf_est(data = margdata@dataexp, method = "cl", constrained = T, q = q)
library(cowplot)
plot_grid(plot(adf_hill), plot(adf_hill2), plot(adf_cl), plot(adf_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
?ismev
mrl.plot(sealevel$dover)
library(ismev)
library(ismev)
mrl.plot(sealevel$dover)
mrl.plot(sealevel$dover[complete.cases(sealevel$dover)])
?evd
install.packages("POT")
library(POT)
?tcplot
tcplot(sealevel$dover[complete.cases(sealevel$dover)])
tcplot(sealevel$dover[complete.cases(sealevel$dover)])
us
### for a few angles
samew <- which(whill %in% w)
ind_whill <- sample(samew, 5, replace = F)
ind_w <- sapply(1:5, function(i) which(w == whill[ind_whill][i]))
adf_gof_hill <- sapply(ind_whill, adf_gof, adf = adf_hill, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_hill2 <- sapply(ind_whill, adf_gof, adf = adf_hill2, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_cl <- sapply(ind_w, adf_gof, adf = adf_cl, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_cl2 <- sapply(ind_w, adf_gof, adf = adf_cl2, blocksize = 1, nboot = 250, alpha = 0.05)
plot_grid(plot(adf_gof_hill[[1]]), plot(adf_gof_hill2[[1]]), plot(adf_gof_cl[[1]]), plot(adf_gof_cl2[[1]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[2]]), plot(adf_gof_hill2[[2]]), plot(adf_gof_cl[[2]]), plot(adf_gof_cl2[[2]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[3]]), plot(adf_gof_hill2[[3]]), plot(adf_gof_cl[[3]]), plot(adf_gof_cl2[[3]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[4]]), plot(adf_gof_hill2[[4]]), plot(adf_gof_cl[[4]]), plot(adf_gof_cl2[[4]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[5]]), plot(adf_gof_hill2[[5]]), plot(adf_gof_cl[[5]]), plot(adf_gof_cl2[[5]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
whill[ind_whill]
1-0.64
prob <- 10/dim(sealevel)[1]
prob
curve_hill <- rc_est(data = sealevel, qmarg = q, w = whill, p = prob, method = "hill", q = q, qalphas = q)
curve_hill2 <- rc_est(data = sealevel, qmarg = q, w = whill, p = prob, method = "hill", q = q, qalphas = q, constrained = T)
curve_cl <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q)
curve_cl2 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, constrained = T)
plot_grid(plot(curve_hill), plot(curve_hill2), plot(curve_cl), plot(curve_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
rc_gof_hill <- rc_gof(curve_hill)
rc_gof_hill2 <- rc_gof(curve_hill2)
rc_gof_cl <- rc_gof(curve_cl)
rc_gof_cl2 <- rc_gof(curve_cl2)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
rc_unc_hill <- rc_unc(curve_hill)
rc_unc_hill2 <- rc_unc(curve_hill2)
rc_unc_cl <- rc_unc(curve_cl)
?rc_unc
curve_cl_optm1 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, par_init = rep(1, k-1))
curve_cl_optm1 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, par_init = rep(1, 5))
curve_cl_optm1 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, par_init = rep(1, 6))
rc_gof_cl <- rc_gof(curve_cl)
rc_unc_cl <- rc_unc(curve_cl_optm1)
curve_cl_optm1 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, par_init = rep(-1, 6))
rc_unc_cl <- rc_unc(curve_cl_optm1)
rc_unc_cl2 <- rc_unc(curve_cl2)
plot(rc_unc_hill)
plot_grid(plot(rc_unc_hill), plot(rc_unc_hill2),
plot(rc_unc_cl), plot(rc_unc_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
?rc_unc
plot_grid(plot(rc_unc_hill, which = "median"), plot(rc_unc_hill2, which = "median"),
plot(rc_unc_cl, which = "median"), plot(rc_unc_cl2, which = "median"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot(rc_unc_hill, which = "median")
plot(rc_unc_hill, which = "mean")
plot(rc_unc_hill, which = "all")
plot_grid(plot(rc_unc_hill, which = "all"), plot(rc_unc_hill2, which = "all"),
plot(rc_unc_cl, which = "all"), plot(rc_unc_cl2, which = "all"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_unc_hill, which = "median"), plot(rc_unc_hill2, which = "median"),
plot(rc_unc_cl, which = "median"), plot(rc_unc_cl2, which = "median"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill, which = "mean"), plot(rc_unc_hill2, which = "mean"),
plot(rc_unc_cl, which = "mean"), plot(rc_unc_cl2, which = "mean"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill, which = "all"), plot(rc_unc_hill2, which = "all"),
plot(rc_unc_cl, which = "all"), plot(rc_unc_cl2, which = "all"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_unc_hill, which = "median"), plot(rc_unc_hill2, which = "median"),
plot(rc_unc_cl, which = "median"), plot(rc_unc_cl2, which = "median"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
library(cowplot)
plot_grid(plot(rc_unc_hill, which = "median"), plot(rc_unc_hill2, which = "median"),
plot(rc_unc_cl, which = "median"), plot(rc_unc_cl2, which = "median"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill, which = "mean"), plot(rc_unc_hill2, which = "mean"),
plot(rc_unc_cl, which = "mean"), plot(rc_unc_cl2, which = "mean"),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
curve_cl_optm2 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, par_init = rep(2, 6))
rc_unc_cl <- rc_unc(curve_cl_optm2)
curve_cl_optm2 <- rc_est(data = sealevel, qmarg = q, p = prob, method = "cl", q = q, qalphas = q, par_init = c(-1, rep(0, 5)))
rc_unc_cl <- rc_unc(curve_cl_optm2)
rc_unc_cl <- rc_unc(curve_cl)
warning()
warnings()
rc_unc_cl <- rc_unc(curve_cl)
warnings()
ismev:::gpd.fit
rc_gof_cl <- rc_gof(curve_cl)
rc_unc_cl <- rc_unc(curve_cl)
warnings()
rc_unc_cl <- rc_unc(curve_cl)
rc_unc_cl <- rc_unc(curve_cl)
evd::mrlplot(sealevel$dover)
evd::tcplot(sealevel$dover)
POT::tcplot(sealevel$dover)
evd::tcplot(complete.cases(sealevel$dover))
POT::tcplot(complete.cases(sealevel$dover))
complete.cases(sealevel$dover)
POT::tcplot(sealevel$dover[complete.cases(sealevel$dover)])
rc_unc_cl <- rc_unc(curve_cl)
rc_unc_cl <- rc_unc(curve_cl)
rc_unc_cl <- rc_unc(curve_cl)
rc_unc_cl <- rc_unc(curve_cl)
rm(list = ls())
rm(list = ls())
library(ReturnCurves)
library(evd)
### sea level 2
data(sealevel2)
?sealevel2
library(ismev)
?ismev
data(engine)
rm(list = ls())
data(engine)
plot(engine)
plot(engine, pch = 20)
plot(engine, pch = 21)
rm(list = ls())
data("euroex")
rm(list = ls())
data(exchange)
plot(exchange, pch = 20)
data("wavesurge")
plot(wavesurge)
?exchange
library(evd)
evd::bvtcplot(exchange)
data("exchange")
evd::bvtcplot(exchange)
?bvtcplot
evd::tcplot(exchange$USD.GBP)
evd::mrlplot(exchange$USD.GBP)
evd::mrlplot(exchange$USD.CAD)
evd::mrlplot(exchange$CAD.GBP)
hist(exchange$USD.GBP[exchange$USD.GBP - quantile(exchange$USD.GBP, 0.95)])
hist(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.95)])
length(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.95)])
length(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.9)])
hist(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.9)])
length(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.95)]-quantile(exchange$USD.GBP, 0.95))
hist(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.95)]-quantile(exchange$USD.GBP, 0.95))
hist(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.9)]-quantile(exchange$USD.GBP, 0.9))
hist(exchange$USD.GBP[exchange$USD.GBP > quantile(exchange$USD.GBP, 0.85)]-quantile(exchange$USD.GBP, 0.85))
hist(exchange$USD.GBP[exchange$CAD.GBP > quantile(exchange$CAD.GBP, 0.9)]-quantile(exchange$CAD.GBP, 0.9))
hist(exchange$USD.GBP[exchange$CAD.GBP > quantile(exchange$CAD.GBP, 0.85)]-quantile(exchange$CAD.GBP, 0.85))
hist(exchange$USD.GBP[exchange$CAD.GBP > quantile(exchange$CAD.GBP, 0.95)]-quantile(exchange$CAD.GBP, 0.95))
hist(exchange$USD.GBP[exchange$CAD.GBP > quantile(exchange$CAD.GBP, 0.9)]-quantile(exchange$CAD.GBP, 0.9))
hist(exchange$USD.GBP[exchange$CAD.GBP > quantile(exchange$CAD.GBP, 0.75)]-quantile(exchange$CAD.GBP, 0.75))
hist(exchange$USD.GBP[exchange$CAD.GBP > quantile(exchange$CAD.GBP, 0.8)]-quantile(exchange$CAD.GBP, 0.8))
source("Downlads/helper_functions.R")
getwd()
source("/home/andrel/Downlads/helper_functions.R")
source("/home/andrel/Downloads/helper_functions.R")
source("/home/andrel/Downloads/thresh_qq_metric.R")
source("/home/andrel/Downloads/thresh_qq_metric.R")
thresh_qq_metric(exchange$USD.GBP)
thresh_qq_metric(exchange$USD.GBP, quantile(exchange$USD.GBP, probs = seq(0, 1, by = 0.05)))
thresh_qq_metric(exchange$CAD.GBP, quantile(exchange$CAD.GBP, probs = seq(0, 1, by = 0.05)))
margdata <- margtransf(exchange, qmarg = 0.9)
margdata <- margtransf(exchange, qmarg = 0.85)
margdata <- margtransf(exchange, qmarg = 0.8)
plot(margdata)
library(ggplot2)
?geom_boxplot
?geom_hist
?geom_histogram
## UK/US and UK/Canada exchange rates
library(ismev)
plot(margdata)
plot(margdata, which = "hist")
plot(margdata, which = "ts")
plot(margdata, which = "joint")
typeof(rep(0.9, 2))
?margtransf
example("margtransf")
rm(list = ls())
library(ReturnCurves)
?margtransf
examples(margtransf())
examples(margtransf
)
example(margtransf)
margtransf(data, c(0.95, 2))
margtransf(data, c(0.95, 0.95))
is.numeric(rep(0.95, 2))
library(ReturnCurves)
example(margtransf)
?rc_est
example(rc_est)
rc_orig <- rc_est(data = data, qmarg = c(0.95, 0.95), p = prob, method = "hill")
plot(rc_orig)
example(rc_est)
rm(list = ls())
library(ReturnCurves)
## UK/US and UK/Canada exchange rates
library(ismev)
data("exchange")
head(exchange)
margdata <- margtransf(exchange, qmarg = c(0.85, 0.95))
plot(margdata)
whill <- seq(0, 1, by = 0.001)
w <- seq(0, 1, by = 0.01)
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = q)
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = 0.95)
q <- 0.95
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = q)
adf_hill2 <- adf_est(data = margdata@dataexp, w = whill, method = "hill", constrained = T, q = q)
adf_cl <- adf_est(data = margdata@dataexp, method = "cl", q = q)
adf_cl2 <- adf_est(data = margdata@dataexp, method = "cl", constrained = T, q = q)
library(cowplot)
plot_grid(plot(adf_hill), plot(adf_hill2), plot(adf_cl), plot(adf_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
q <- 0.8
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = q)
adf_hill2 <- adf_est(data = margdata@dataexp, w = whill, method = "hill", constrained = T, q = q)
adf_cl <- adf_est(data = margdata@dataexp, method = "cl", q = q)
adf_cl2 <- adf_est(data = margdata@dataexp, method = "cl", constrained = T, q = q)
library(cowplot)
plot_grid(plot(adf_hill), plot(adf_hill2), plot(adf_cl), plot(adf_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
q <- 0.85
adf_hill <- adf_est(data = margdata@dataexp, w = whill, method = "hill", q = q)
adf_hill2 <- adf_est(data = margdata@dataexp, w = whill, method = "hill", constrained = T, q = q)
adf_cl <- adf_est(data = margdata@dataexp, method = "cl", q = q)
adf_cl2 <- adf_est(data = margdata@dataexp, method = "cl", constrained = T, q = q)
library(cowplot)
plot_grid(plot(adf_hill), plot(adf_hill2), plot(adf_cl), plot(adf_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
samew <- which(whill %in% w)
ind_whill <- sample(samew, 5, replace = F)
ind_w <- sapply(1:5, function(i) which(w == whill[ind_whill][i]))
adf_gof_hill <- sapply(ind_whill, adf_gof, adf = adf_hill, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_hill2 <- sapply(ind_whill, adf_gof, adf = adf_hill2, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_cl <- sapply(ind_w, adf_gof, adf = adf_cl, blocksize = 1, nboot = 250, alpha = 0.05)
adf_gof_cl2 <- sapply(ind_w, adf_gof, adf = adf_cl2, blocksize = 1, nboot = 250, alpha = 0.05)
plot_grid(plot(adf_gof_hill[[1]]), plot(adf_gof_hill2[[1]]), plot(adf_gof_cl[[1]]), plot(adf_gof_cl2[[1]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[2]]), plot(adf_gof_hill2[[2]]), plot(adf_gof_cl[[2]]), plot(adf_gof_cl2[[2]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[3]]), plot(adf_gof_hill2[[3]]), plot(adf_gof_cl[[3]]), plot(adf_gof_cl2[[3]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[4]]), plot(adf_gof_hill2[[4]]), plot(adf_gof_cl[[4]]), plot(adf_gof_cl2[[4]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(adf_gof_hill[[5]]), plot(adf_gof_hill2[[5]]), plot(adf_gof_cl[[5]]), plot(adf_gof_cl2[[5]]),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
whill[ind_whill]
prob <- 10/dim(exchange)[1]
prob
curve_hill <- rc_est(data = exchange, qmarg = c(0.85, 0.95), w = whill, p = prob, method = "hill", q = q, qalphas = q)
curve_hill2 <- rc_est(data = exchange, qmarg = c(0.85, 0.95), w = whill, p = prob, method = "hill", q = q, qalphas = q, constrained = T)
curve_cl <- rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q)
curve_cl2 <- rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, constrained = T)
plot_grid(plot(curve_hill), plot(curve_hill2), plot(curve_cl), plot(curve_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
rc_gof_hill <- rc_gof(curve_hill)
rc_gof_hill2 <- rc_gof(curve_hill2)
rc_gof_cl <- rc_gof(curve_cl)
rc_gof_cl2 <- rc_gof(curve_cl2)
plot_grid(plot(rc_gof_hill), plot(rc_gof_hill2), plot(rc_gof_cl), plot(rc_gof_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
rc_unc_hill <- rc_unc(curve_hill)
rc_unc_hill2 <- rc_unc(curve_hill2)
rc_unc_cl <- rc_unc(curve_cl)
rc_unc_cl2 <- rc_unc(curve_cl2)
rc_gof_cl <- rc_gof(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = c(-1, rep(0, 5))))
rc_gof_cl <- rc_gof(curve_cl)
rc_unc_cl <- rc_unc(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = c(-1, rep(0, 5))))
rc_unc_cl <- rc_unc(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = c(rep(-1, 6))))
rc_unc_cl <- rc_unc(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = c(rep(-2, 6))))
rc_unc_cl <- rc_unc(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = c(-1, -2, 1, 0, 1, -1)))
rc_unc_cl <- rc_unc(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = rep(-5, 6)))
rc_unc_cl <- rc_unc(rc_est(data = exchange, qmarg = c(0.85, 0.95), p = prob, method = "cl", q = q, qalphas = q, par_init = rep(-10, 6)))
plot_grid(plot(rc_unc_hill), plot(rc_unc_hill2), plot(rc_unc_cl2),
nrow = 2, labels = list("H", "H2", "CL", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill), plot(rc_unc_hill2), plot(rc_unc_cl2),
nrow = 2, labels = list("H", "H2", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill, which = "median"), plot(rc_unc_hill2, which = "median"), plot(rc_unc_cl2, which = "median"),
nrow = 2, labels = list("H", "H2", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill, which = "mean"), plot(rc_unc_hill2, which = "mean"), plot(rc_unc_cl2, which = "mean"),
nrow = 2, labels = list("H", "H2", "CL2"), label_size = 10)
plot_grid(plot(rc_unc_hill, which = "all"), plot(rc_unc_hill2, which = "all"), plot(rc_unc_cl2, which = "all"),
nrow = 2, labels = list("H", "H2", "CL2"), label_size = 10)
